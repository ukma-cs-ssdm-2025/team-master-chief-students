{
	"info": {
		"_postman_id": "b65e0209-5242-4c96-a5fe-b0e187502ed4",
		"name": "Expense Tracker - Teams & Cursor Pagination",
		"description": "Complete collection for testing Teams functionality and cursor-based pagination",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "47864958"
	},
	"item": [
		{
			"name": "1. Authentication",
			"item": [
				{
					"name": "Login - Alice",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const jsonData = pm.response.json();",
									"    pm.collectionVariables.set(\"accessToken\", jsonData.data.accessToken);",
									"    pm.collectionVariables.set(\"userId\", \"1\");",
									"    pm.collectionVariables.set(\"userEmail\", \"alice@example.com\");",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\": \"alice@example.com\",\n    \"password\": \"password123\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/auth/login",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"auth",
								"login"
							]
						}
					},
					"response": []
				},
				{
					"name": "Login - Bob",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const jsonData = pm.response.json();",
									"    pm.collectionVariables.set(\"bobAccessToken\", jsonData.data.accessToken);",
									"    pm.collectionVariables.set(\"bobUserId\", \"2\");",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\": \"bob@example.com\",\n    \"password\": \"password123\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/auth/login",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"auth",
								"login"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "2. Teams Management",
			"item": [
				{
					"name": "Create Team",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const jsonData = pm.response.json();",
									"    pm.collectionVariables.set(\"teamId\", jsonData.data.id);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"My New Team\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/teams",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"teams"
							]
						}
					},
					"response": []
				},
				{
					"name": "List My Teams",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/teams",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"teams"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Team Details",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200 && !pm.collectionVariables.get(\"teamId\")) {",
									"    const jsonData = pm.response.json();",
									"    if (jsonData.data && jsonData.data.id) {",
									"        pm.collectionVariables.set(\"teamId\", jsonData.data.id);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/teams/{{teamId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"teams",
								"{{teamId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Add Team Member",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    console.log(\"Member added successfully\");",
									"}"
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"userId\": 1,\n    \"role\": \"MEMBER\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/teams/{{teamId}}/members",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"teams",
								"{{teamId}}",
								"members"
							]
						}
					},
					"response": []
				},
				{
					"name": "Change Member Role",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/teams/{{teamId}}/members/1?role=ADMIN",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"teams",
								"{{teamId}}",
								"members",
								"1"
							],
							"query": [
								{
									"key": "role",
									"value": "ADMIN"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Remove Team Member",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/teams/{{teamId}}/members/1",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"teams",
								"{{teamId}}",
								"members",
								"1"
							]
						}
					},
					"response": []
				}
			],
			"auth": {
				"type": "bearer",
				"bearer": [
					{
						"key": "token",
						"value": "{{ jwt_token}}",
						"type": "string"
					}
				]
			},
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"type": "text/javascript",
						"packages": {},
						"requests": {},
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"type": "text/javascript",
						"packages": {},
						"requests": {},
						"exec": [
							""
						]
					}
				}
			]
		},
		{
			"name": "3. Team Expenses",
			"item": [
				{
					"name": "Create Team Expense",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    console.log(\"Team expense created\");",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"categoryId\": 1,\n    \"description\": \"Team lunch meeting\",\n    \"amount\": 150.50,\n    \"date\": \"2025-01-15\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/teams/{{teamId}}/expenses",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"teams",
								"{{teamId}}",
								"expenses"
							]
						}
					},
					"response": []
				},
				{
					"name": "List Team Expenses - First Page",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const jsonData = pm.response.json();",
									"    const pageData = jsonData.data;",
									"    if (pageData && pageData.nextCursor) {",
									"        pm.collectionVariables.set(\"nextCursor\", pageData.nextCursor);",
									"        console.log(\"Next cursor saved: \" + pageData.nextCursor);",
									"    }",
									"    console.log(\"Has next page: \" + pageData.hasNext);",
									"    console.log(\"Items count: \" + pageData.size);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/teams/{{teamId}}/expenses?limit=5",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"teams",
								"{{teamId}}",
								"expenses"
							],
							"query": [
								{
									"key": "limit",
									"value": "5"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "List Team Expenses - Next Page (with cursor)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/teams/{{teamId}}/expenses?cursor={{nextCursor}}&limit=5",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"teams",
								"{{teamId}}",
								"expenses"
							],
							"query": [
								{
									"key": "cursor",
									"value": "{{nextCursor}}"
								},
								{
									"key": "limit",
									"value": "5"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "List Team Expenses - All (no cursor)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/teams/{{teamId}}/expenses?limit=20",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"teams",
								"{{teamId}}",
								"expenses"
							],
							"query": [
								{
									"key": "limit",
									"value": "20"
								}
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "4. Expense Sharing",
			"item": [
				{
					"name": "Get Personal Expenses",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const jsonData = pm.response.json();",
									"    if (jsonData.data && jsonData.data.length > 0) {",
									"        pm.collectionVariables.set(\"personalExpenseId\", jsonData.data[0].id);",
									"        console.log(\"Personal expense ID: \" + jsonData.data[0].id);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/expenses",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"expenses"
							]
						}
					},
					"response": []
				},
				{
					"name": "Share Personal Expense to Team",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"teamId\": {{teamId}},\n    \"mode\": \"MOVE\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/expenses/{{personalExpenseId}}/share",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"expenses",
								"{{personalExpenseId}}",
								"share"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "FLOW 1: Complete Team Workflow",
			"item": [
				{
					"name": "Step 1: Login",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\": \"alice@example.com\",\n    \"password\": \"password123\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/auth/login",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"auth",
								"login"
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 2: Create Team",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"Flow Test Team\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/teams",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"teams"
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 3: Add Member (Bob)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"userId\": 2,\n    \"role\": \"MEMBER\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/teams/{{teamId}}/members",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"teams",
								"{{teamId}}",
								"members"
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 4: Create Team Expense",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"categoryId\": 1,\n    \"description\": \"Flow test expense\",\n    \"amount\": 99.99,\n    \"date\": \"2025-01-20\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/teams/{{teamId}}/expenses",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"teams",
								"{{teamId}}",
								"expenses"
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 5: List Expenses (Cursor Pagination - Page 1)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/teams/{{teamId}}/expenses?limit=3",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"teams",
								"{{teamId}}",
								"expenses"
							],
							"query": [
								{
									"key": "limit",
									"value": "3"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 6: List Expenses (Cursor Pagination - Page 2)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/teams/{{teamId}}/expenses?cursor={{nextCursor}}&limit=3",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"teams",
								"{{teamId}}",
								"expenses"
							],
							"query": [
								{
									"key": "cursor",
									"value": "{{nextCursor}}"
								},
								{
									"key": "limit",
									"value": "3"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 7: Get Team Details",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/teams/{{teamId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"teams",
								"{{teamId}}"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "FLOW 2: Share Personal Expense",
			"item": [
				{
					"name": "Step 1: Login",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\": \"alice@example.com\",\n    \"password\": \"password123\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/auth/login",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"auth",
								"login"
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 2: Get First Team (or use existing)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/teams",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"teams"
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 3: Get Personal Expenses",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/expenses",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"expenses"
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 4: Share Expense to Team (MOVE)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"teamId\": {{teamId}},\n    \"mode\": \"MOVE\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/expenses/{{personalExpenseId}}/share",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"expenses",
								"{{personalExpenseId}}",
								"share"
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 5: Verify in Team Expenses",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/teams/{{teamId}}/expenses?limit=20",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"teams",
								"{{teamId}}",
								"expenses"
							],
							"query": [
								{
									"key": "limit",
									"value": "20"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 6: Verify Removed from Personal",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/expenses",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"expenses"
							]
						}
					},
					"response": []
				}
			]
		}
	],
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:8080",
			"type": "string"
		},
		{
			"key": "accessToken",
			"value": "",
			"type": "string"
		},
		{
			"key": "teamId",
			"value": "",
			"type": "string"
		},
		{
			"key": "nextCursor",
			"value": "",
			"type": "string"
		},
		{
			"key": "personalExpenseId",
			"value": "",
			"type": "string"
		},
		{
			"key": "userId",
			"value": ""
		},
		{
			"key": "userEmail",
			"value": ""
		},
		{
			"key": " jwt_token",
			"value": "",
			"type": "default"
		},
		{
			"key": "bobAccessToken",
			"value": ""
		},
		{
			"key": "bobUserId",
			"value": ""
		}
	]
}